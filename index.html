<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    
    <!-- Resource Hints -->
    <link rel="preconnect" href="https://ik.imagekit.io" crossorigin>
    <link rel="dns-prefetch" href="https://ik.imagekit.io">
    <link rel="preconnect" href="https://www.googletagmanager.com" crossorigin>
    <link rel="dns-prefetch" href="https://www.googletagmanager.com">
    
    <!-- Preload Critical Assets -->
    <link rel="preload" as="image" href="https://ik.imagekit.io/appraisily/WebPage/hero_background.jpg?tr=w-1920,h-1080,q-50" fetchpriority="high">
    <link rel="preload" as="image" href="https://ik.imagekit.io/appraisily/WebPage/logo_new.png?tr=w-64,h-64" fetchpriority="high">
    <link rel="modulepreload" href="/src/main.tsx" as="script">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="https://ik.imagekit.io/appraisily/WebPage/logo_new.png?tr=w-32,h-32" />
    
    <!-- Deferred Analytics -->
    <script type="module">
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-V8T1NRDNC6', {
        send_page_view: false,
        transport_type: 'beacon',
        anonymize_ip: true,
        cookie_flags: 'SameSite=None;Secure'
      });

      // Load analytics only when the user interacts or after 5 seconds
      const loadAnalytics = () => {
        if (window.analyticsLoaded) return;
        window.analyticsLoaded = true;
        
        const script = document.createElement('script');
        script.src = 'https://www.googletagmanager.com/gtag/js?id=G-V8T1NRDNC6';
        script.async = true;
        document.head.appendChild(script);
        
        // Send initial page view after analytics loads
        script.onload = () => gtag('event', 'page_view');
      };

      // Load on user interaction
      const events = ['mousedown', 'keydown', 'scroll', 'touchstart'];
      const observer = new IntersectionObserver((entries) => {
        if (entries[0].isIntersecting) {
          loadAnalytics();
          observer.disconnect();
        }
      });

      // Observe viewport
      observer.observe(document.documentElement);

      // Fallback: Load after user interaction or 5 seconds
      events.forEach(event => {
        document.addEventListener(event, loadAnalytics, { once: true, passive: true });
      });
      setTimeout(loadAnalytics, 5000);
    </script>

    <!-- Tawk.to Chat Widget -->
    <script type="module">
      const loadChat = () => {
        const s1 = document.createElement("script");
        s1.async = true;
        s1.src = 'https://embed.tawk.to/63a083dbb0d6371309d528e2/1gklg645r';
        s1.setAttribute('crossorigin','*');
        document.head.appendChild(s1);
      };

      // Load chat when user scrolls near footer
      const observer = new IntersectionObserver((entries) => {
        if (entries[0].isIntersecting) {
          loadChat();
          observer.disconnect();
        }
      }, { rootMargin: '200px' });

      // Start observing when page loads
      window.addEventListener('load', () => {
        const footer = document.querySelector('footer');
        if (footer) observer.observe(footer);
      });
    </script>

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Expert Art Appraisals | Professional Valuation Services</title>
    
    <!-- Meta Tags -->
    <meta name="description" content="Professional art and antique appraisal services starting at $59. Get your artwork valued by certified experts within 24-48 hours. IRS & Insurance compliant reports.">
    <meta name="theme-color" content="rgb(37 99 235)">
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>